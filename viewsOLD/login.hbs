<form id="myForm" method="post">
	<input type="email" name="email" placeholder="Tu Email">
	<br><br>
	<input type="password" name="password" placeholder="Tu ContraseÃ±a">
	<br>
	<input type="submit" name="submit" value="Login">	
</form>

<script type="text/javascript">	
	const formLogin = document.getElementById('myForm');
	//console.log("formLogin", formLogin);
	

	formLogin.addEventListener('submit', function(event) {
		event.preventDefault()		
		const formData = new URLSearchParams(new FormData(formLogin));
		fetch('/api/signin', {
			method: 'POST',
			body: formData
		})
		//.then(res => res.json())
		.then(res => {
			if (res.status >= 400 && res.status < 600) {
	      		console.log(res)
	      		throw new Error(res.msg);
		    }
		    return res.json();
		})
		.then(data =>{			
			console.log(data)
			localStorage.setItem('token', data.token)
			localStorage.setItem('rol', data.rol)
			localStorage.setItem('displayName', data.displayName)
			localStorage.setItem('_id', data._id)
			location.assign('/listausuarios');
		})
		.catch((error) =>{
			console.log(`Error en el fetch de signin: ${error}`)
		})
	})	
</script>