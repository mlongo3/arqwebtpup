<form id="myForm" method="post">
	<input type="email" name="email" placeholder="Tu Email">
	<br><br>
	<input type="password" name="password" placeholder="Tu ContraseÃ±a">
	<br>
	<input type="submit" name="submit" value="Login">	
</form>

<script type="text/javascript">
	//usamos  vanillaJS para no importar mas librerias
	const formLogin = document.getElementById('myForm');
	console.log("formLogin", formLogin);
	//var x = document.querySelector('#login')
	//console.log("x", x);


	//Datos del formulario y usamos una API de Js que se llama FormData y le pasamos el formulario.
	//const formData = new FormData(formLogin) 
	//const formData = new URLSearchParams(new FormData(formLogin));

	formLogin.addEventListener('submit', function(event) {
		event.preventDefault()		
		const formData = new URLSearchParams(new FormData(formLogin));
		fetch('/api/signin', {
			method: 'POST',
			body: formData
		})
		//.then(res => res.json())
		.then(res => {
			if (res.status >= 400 && res.status < 600) {
	      		throw new Error("No podes por algun error");
		    }
		    return res.json();
		})
		.then(data =>{			
			console.log(data)
			localStorage.setItem('token', data.token)
			location.assign('/listaproductos');
		})
		.catch((error) =>{
		console.log(`Error durante los Fetch de login: ${error}`)
	})
	})	
</script>